{"version":3,"sources":["components/Table.js","containers/FakeSheet.js","index.js"],"names":["Table","props","isNumeric","s","isNaN","ij2id","i","j","col_id2str","id2ij","id","toUpperCase","length","d1","charCodeAt","d2","r_i","r_j","v","col_str2id","slice","parseInt","cell_blur","console","log","fcs_in","document","getElementById","fcs_i","fcs_j","classList","remove","state","cList","isFunc","content","value","e_flag","fcs","clk","setState","flag","cell_clk","add","cell_key","e","key","ni","Math","min","row_num","focus","pass_cell","src_i","src_j","tar_i","tar_j","prop","undefined","renew_cell_func","mode","c","FuncType","del","FuncRef","l","copy_cell","copied_cell","cell","copied_ij","paste_cell","dij","sign","parse_func","FuncErr","add_col","col_num","push","add_row","new_row","del_col","splice","del_row","sum_cells","sum","parseFloat","FuncValue","rm_space","str","sub_str","trim","split","new_str","in_str","c1","c2","inrange","x","src","src_ref","loop","get_cell_value","includes","NaN","this","ij","nextProps","nextState","t","rows","arow","concat","map","index","type","onClick","onBlur","onKeyDown","className","onMouseDown","a0","String","fromCharCode","l1","l2","Component","FakeSheet","text","ReactDOM","render"],"mappings":"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","file":"static/js/main.7adb5750.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nclass Table extends Component {\r\n  static col_id2str(id) {\r\n    var a0 = \"A\".charCodeAt(0);\r\n    if (id < 26) return String.fromCharCode(a0 + id);\r\n    else {\r\n      var l1 = parseInt(id / 26) - 1;\r\n      var l2 = id % 26;\r\n      return String.fromCharCode(a0 + l1) + String.fromCharCode(a0 + l2);\r\n    }\r\n  }\r\n  static col_str2id(str) {\r\n    var id = 0;\r\n    var a0 = \"A\".charCodeAt(0);\r\n    if (str.length === 1) id = str.charCodeAt(0) - a0;\r\n    else {\r\n      id = 26;\r\n      id += 26 * (str.charCodeAt(0) - a0);\r\n      id += str.charCodeAt(1) - a0;\r\n    }\r\n    return id;\r\n  }\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { row_num: 100, col_num: 26, cList: [], fcs: [-1, -1], flag: 0 };\r\n    this.cell = class cell {\r\n      constructor() {\r\n        this.clk = 0;\r\n        this.isFunc = false;\r\n        this.FuncType = \"NULL\";\r\n        this.FuncErr = false;\r\n        this.FuncValue = 0;\r\n        this.FuncRef = [\r\n          [-1, -1],\r\n          [-1, -1],\r\n        ];\r\n        this.content = \"\";\r\n      }\r\n    };\r\n    this.copied_cell=undefined;\r\n    this.copied_ij=[-1,-1];\r\n    this.e_flag = true;\r\n    for (let i = 0; i < this.state.row_num; i++) {\r\n      this.state.cList.push([]);\r\n      for (let j = 0; j < this.state.col_num; j++) {\r\n        this.state.cList[i].push(new this.cell());\r\n      }\r\n    }\r\n  }\r\n  isNumeric = (s) => {\r\n    return !isNaN(s);\r\n  };\r\n  ij2id = (i, j) => {\r\n    let s = Table.col_id2str(j) + (i + 1);\r\n    return s;\r\n  };\r\n  id2ij = (id) => {\r\n    id = id.toUpperCase();\r\n    if (id.length >= 2) {\r\n      var d1 = id.charCodeAt(0) - \"A\".charCodeAt(0);\r\n      var d2 = id.charCodeAt(1) - \"A\".charCodeAt(0);\r\n      var r_i = 0,\r\n        r_j = 0;\r\n      var v = false;\r\n      if (d1 >= 0 && d1 < 26) {\r\n        if (d2 >= 0 && d2 < 26) {\r\n          r_j = Table.col_str2id(id.slice(0, 2));\r\n          if (this.isNumeric(id.slice(2))) {\r\n            r_i = parseInt(id.slice(2)) - 1;\r\n            v = true;\r\n          }\r\n        } else {\r\n          r_j = Table.col_str2id(id.slice(0, 1));\r\n          if (this.isNumeric(id.slice(1))) {\r\n            r_i = parseInt(id.slice(1)) - 1;\r\n            v = true;\r\n          }\r\n        }\r\n      }\r\n      if (v) return [r_i, r_j];\r\n    }\r\n    return [-1, -1];\r\n  };\r\n  cell_blur = (i, j) => {\r\n    console.log(\"blur\");\r\n    var fcs_in = document.getElementById(this.ij2id(i, j));\r\n    var fcs_i = document.getElementById(\"th\" + (i + 1));\r\n    var fcs_j = document.getElementById(\"th\" + Table.col_id2str(j));\r\n    fcs_i.classList.remove(\"fcs\");\r\n    fcs_j.classList.remove(\"fcs\");\r\n    if (!this.state.cList[i][j].isFunc)\r\n      this.state.cList[i][j].content = fcs_in.value;\r\n    if (this.e_flag) this.state.fcs = [-1, -1];\r\n    this.e_flag = true;\r\n    this.state.cList[i][j].clk = 0;\r\n    this.setState((state) => ({ flag: state.flag + 1 }));\r\n  };\r\n  cell_clk = (i, j) => {\r\n    var fcs_in = document.getElementById(this.ij2id(i, j));\r\n    var fcs_i = document.getElementById(\"th\" + (i + 1));\r\n    var fcs_j = document.getElementById(\"th\" + Table.col_id2str(j));\r\n    fcs_i.classList.add(\"fcs\");\r\n    fcs_j.classList.add(\"fcs\");\r\n    if (this.state.cList[i][j].clk === 0) {\r\n      this.state.fcs = [i, j];\r\n      fcs_in.value = this.state.cList[i][j].content;\r\n      let s = this.ij2id(i, j);\r\n      // console.log(\"First:\"+s);\r\n      this.state.cList[i][j].clk = 1;\r\n    } else if (this.state.cList[i][j].clk === 1) {\r\n      let s = this.ij2id(i, j);\r\n      // console.log(\"Second:\"+s);\r\n      this.state.cList[i][j].clk = 2;\r\n    }\r\n  };\r\n  cell_key = (i, j, e) => {\r\n    if (e.key === \"Enter\") {\r\n      this.e_flag = false;\r\n      var fcs_in = document.getElementById(this.ij2id(i, j));\r\n      if (this.state.cList[i][j].clk == 2)\r\n        this.state.cList[i][j].content = fcs_in.value;\r\n      var ni = Math.min(i + 1, this.state.row_num - 1);\r\n      this.state.fcs = [ni, j];\r\n      document.getElementById(this.ij2id(ni, j)).focus();\r\n      var fcs_i = document.getElementById(\"th\" + (ni + 1));\r\n      var fcs_j = document.getElementById(\"th\" + Table.col_id2str(j));\r\n      fcs_i.classList.add(\"fcs\");\r\n      fcs_j.classList.add(\"fcs\");\r\n      this.state.cList[ni][j].clk = 1;\r\n      this.setState((state) => ({ flag: state.flag + 1 }));\r\n      return;\r\n    }\r\n    if (this.state.cList[i][j].clk === 1) {\r\n      if (e.key === \"Backspace\" || e.key === \"Delete\") {\r\n        document.getElementById(this.ij2id(i, j)).value = \"\";\r\n        this.state.cList[i][j].clk = 2;\r\n      } else {\r\n        document.getElementById(this.ij2id(i, j)).value = \"\";\r\n        this.state.cList[i][j].clk = 2;\r\n      }\r\n    }\r\n  };\r\n\r\n  pass_cell = (src_i, src_j, tar_i, tar_j) => {\r\n    for (let prop in this.state.cList[src_i][src_j]) {\r\n      if (prop !== undefined)\r\n        this.state.cList[tar_i][tar_j][prop] = this.state.cList[src_i][src_j][\r\n          prop\r\n        ];\r\n    }\r\n  };\r\n  renew_cell_func = (i, j, mode, fcs) => {\r\n    var c = this.state.cList[i][j];\r\n    var FuncType = c.FuncType;\r\n    if(FuncType ===\"NULL\") return false;\r\n    var del=false;\r\n    if (FuncType === \"ref\") { \r\n      console.log(c.FuncRef[0]);\r\n      console.log(fcs);\r\n      if (mode === \"+r\") {\r\n          if (c.FuncRef[0][0] >= fcs[0]) c.FuncRef[0][0]++;\r\n        }\r\n        else if (mode === \"-r\") {\r\n          if (c.FuncRef[0][0] > fcs[0]) c.FuncRef[0][0]--;  \r\n          else if(c.FuncRef[0][0] == fcs[0]&&fcs[0]!==-1)  del=true;  \r\n      } else if (mode === \"+c\") {\r\n        if (c.FuncRef[0][1] >= fcs[1]) c.FuncRef[0][1]++;}\r\n       else if (mode === \"-c\") {\r\n        if (c.FuncRef[0][1] > fcs[1]) c.FuncRef[0][1]--; \r\n        else if(c.FuncRef[0][1] == fcs[1]&&fcs[1]!==-1)  del=true;\r\n      }\r\n      if(del){\r\n        c.content=\"ERROR!\"\r\n        c.isFunc=false;\r\n      }\r\n      else{    \r\n      c.content =\r\n        \"=\"+this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) ;\r\n      }\r\n    }\r\n    else {\r\n      if (mode === \"+r\") {\r\n        for (let l = 0; l < 2; l++) {\r\n          if (c.FuncRef[l][0] >= fcs[0]) c.FuncRef[l][0]++;\r\n        }\r\n      } else if (mode === \"-r\") {\r\n        for (let l = 0; l < 2; l++) {\r\n          if (c.FuncRef[l][0] > fcs[0]) c.FuncRef[l][0]--;\r\n          else if(c.FuncRef[l][0] == fcs[0]&&fcs[0]!==-1)  del=true;  \r\n        }\r\n      } else if (mode === \"+c\") {\r\n        for (let l = 0; l < 2; l++) {\r\n          if (c.FuncRef[l][1] >= fcs[1]) c.FuncRef[l][1]++;\r\n        }\r\n      } else if (mode === \"-c\") {\r\n        for (let l = 0; l < 2; l++) {\r\n          if (c.FuncRef[l][1] > fcs[1]) c.FuncRef[l][1]--;\r\n          else if(c.FuncRef[l][1] == fcs[1]&&fcs[1]!==-1)  del=true;  \r\n        }\r\n    }\r\n    if (FuncType === \"sum\") {\r\n      if(del){\r\n        c.content=\"ERROR!\"\r\n        c.isFunc=false;\r\n      }\r\n      else\r\n      this.state.cList[i][j].content =\r\n        \"=sum(\" +\r\n        this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) +\r\n        \":\" +\r\n        this.ij2id(c.FuncRef[1][0], c.FuncRef[1][1]) +\r\n        \")\";\r\n    } else if (FuncType === \"plus\") {\r\n      if(del){\r\n        c.content=\"ERROR!\"\r\n        c.isFunc=false;\r\n      }\r\n      else\r\n      this.state.cList[i][j].content =\r\n      \"=\"+\r\n      this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) +\r\n      \"+\" +\r\n      this.ij2id(c.FuncRef[1][0], c.FuncRef[1][1]);\r\n    }\r\n    else if (FuncType === \"minus\") {\r\n      if(del){\r\n        c.content=\"ERROR!\"\r\n        c.isFunc=false;\r\n      }\r\n      else\r\n      c.content =\r\n      \"=\"+\r\n      this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) +\r\n      \"-\" +\r\n      this.ij2id(c.FuncRef[1][0], c.FuncRef[1][1]);\r\n    }}\r\n  };\r\n  copy_cell = (fcs) => {\r\n    if(fcs[0]!==-1){\r\n      if(this.copied_cell===undefined){\r\n        this.copied_cell = new this.cell();\r\n      }\r\n      for (let prop in this.state.cList[fcs[0]][fcs[1]]) {\r\n          if (prop !== undefined)\r\n          this.copied_cell[prop] = this.state.cList[fcs[0]][fcs[1]][prop];\r\n      }\r\n      this.copied_ij=fcs;\r\n    }\r\n    \r\n  };\r\n  paste_cell = (fcs) => {\r\n    if(fcs[0]!==-1){\r\n      var c=this.state.cList[fcs[0]][fcs[1]];\r\n      if(this.copied_cell!==undefined){\r\n        for (let prop in this.copied_cell) {\r\n          if (prop !== undefined)  c[prop]=this.copied_cell[prop];\r\n        }\r\n        if(c.isFunc){\r\n          var dij=[fcs[0]-this.copied_ij[0],fcs[1]-this.copied_ij[1]];\r\n          if(c.FuncType ===\"sum\"){\r\n            for(let l=0;l<2;l++){\r\n              for(let i=0;i<2;i++){\r\n                c.FuncRef[l][i]+=dij[i];\r\n              }\r\n            }\r\n            c.content =\r\n            \"=sum(\" +\r\n            this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) +\r\n            \":\" +\r\n            this.ij2id(c.FuncRef[1][0], c.FuncRef[1][1]) +\r\n            \")\";\r\n          }else if(c.FuncType ===\"ref\"){\r\n              for(let i=0;i<2;i++){\r\n                c.FuncRef[0][i]+=dij[i];\r\n              }\r\n              c.content =\r\n              \"=\"+\r\n              this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) \r\n          }else if(c.FuncType ===\"minus\"||c.FuncType ===\"plus\"){\r\n            for(let l=0;l<2;l++){\r\n              for(let i=0;i<2;i++){\r\n                if(c.FuncRef[l][i]!==-1)  c.FuncRef[l][i]+=dij[i];\r\n              }\r\n            }\r\n            var sign;\r\n            if(c.FuncType ===\"minus\") sign=\"-\";\r\n            else if(c.FuncType ===\"plus\") sign=\"+\";\r\n            c.content =\r\n            \"=\"+\r\n            this.ij2id(c.FuncRef[0][0], c.FuncRef[0][1]) +\r\n            sign +\r\n            this.ij2id(c.FuncRef[1][0], c.FuncRef[1][1]);\r\n          }\r\n          this.parse_func(fcs[0],fcs[1],c.content);\r\n          if(c.FuncErr) {\r\n            c.content=\"ERROR!\"\r\n            c.isFunc=false;\r\n          }\r\n        }\r\n        this.setState((state) => ({ flag: state.flag + 1 }));\r\n      }\r\n    }\r\n  };\r\n  add_col = (fcs) => {\r\n    if (fcs[1] === -1) {\r\n      fcs = [0, this.state.col_num - 1];\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        this.state.cList[i].push(new this.cell());\r\n      }\r\n    } else {\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          if (this.state.cList[i][j].isFunc)\r\n            this.renew_cell_func(i, j, \"+c\", fcs);\r\n        }\r\n      }\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        this.state.cList[i].push(new this.cell());\r\n        //console.log(this.state.cList[i]);\r\n        for (let j = this.state.col_num; j > fcs[1]; j--) {\r\n          //console.log(j-1+\"=>\"+j);\r\n          this.pass_cell(i, j - 1, i, j);\r\n        }\r\n        this.state.cList[i][fcs[1]] = new this.cell();\r\n      }\r\n    }\r\n    //this.state.fcs=[fcs[0],fcs[1]+1];\r\n    this.setState((state) => ({ col_num: state.col_num + 1 }));\r\n  };\r\n  add_row = (fcs) => {\r\n    if (fcs[0] === -1) {\r\n      fcs = [this.state.row_num - 1, 0];\r\n      var new_row = [];\r\n      for (let j = 0; j < this.state.col_num; j++) {\r\n        new_row.push(new this.cell());\r\n      }\r\n      this.state.cList.push(new_row);\r\n    } else {\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          if (this.state.cList[i][j].isFunc)\r\n            this.renew_cell_func(i, j, \"+r\", fcs);\r\n        }\r\n      }\r\n      var new_row = [];\r\n      //console.log(\"add c\"+fcs[0]);\r\n      for (let j = 0; j < this.state.col_num; j++) {\r\n        new_row.push(new this.cell());\r\n      }\r\n      this.state.cList.push(new_row);\r\n      for (let i = this.state.row_num; i > fcs[0]; i--) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          this.pass_cell(i - 1, j, i, j);\r\n        }\r\n      }\r\n      for (let j = 0; j < this.state.col_num; j++) {\r\n        this.state.cList[fcs[0]][j] = new this.cell();\r\n      }\r\n    }\r\n    //this.state.fcs=[fcs[0]+1,fcs[1]];\r\n    this.setState((state) => ({ row_num: state.row_num + 1 }));\r\n  };\r\n  del_col = (fcs) => {\r\n    if (fcs[1] !== -1) {\r\n      var fcs_i = document.getElementById(\"th\" + (fcs[0] + 1));\r\n      var fcs_j = document.getElementById(\"th\" + Table.col_id2str(fcs[1]));\r\n      fcs_i.classList.remove(\"fcs\");\r\n      fcs_j.classList.remove(\"fcs\");\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          if (this.state.cList[i][j].isFunc)\r\n            this.renew_cell_func(i, j, \"-c\", fcs);\r\n        }\r\n      }\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = fcs[1]; j < this.state.col_num - 1; j++) {\r\n          this.pass_cell(i, j + 1, i, j);\r\n        }\r\n        this.state.cList[i].splice(this.state.col_num - 1, 1);\r\n      }\r\n      this.state.fcs = [-1, -1];\r\n      this.state.col_num--;\r\n      this.setState((state) => ({ flag: state.flag - 1 }));\r\n    }\r\n  };\r\n  del_row = (fcs) => {\r\n    if (fcs[0] !== -1) {\r\n      var fcs_i = document.getElementById(\"th\" + (fcs[0] + 1));\r\n      var fcs_j = document.getElementById(\"th\" + Table.col_id2str(fcs[1]));\r\n      fcs_i.classList.remove(\"fcs\");\r\n      fcs_j.classList.remove(\"fcs\");\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          if (this.state.cList[i][j].isFunc)\r\n            this.renew_cell_func(i, j, \"-r\", fcs);\r\n        }\r\n      }\r\n      for (let i = fcs[0]; i < this.state.row_num - 1; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          this.pass_cell(i + 1, j, i, j);\r\n        }\r\n      }\r\n      this.state.cList.splice(this.state.row_num - 1, 1);\r\n      this.state.fcs = [-1, -1];\r\n      this.state.row_num--;\r\n\r\n      this.setState((state) => ({ flag: state.flag - 1 }));\r\n    }\r\n  };\r\n  sum_cells=(src_i,src_j,tar_i,tar_j)=>{\r\n    if(src_i>tar_i || src_j>tar_j) return false;\r\n    var sum=0;\r\n    for(let i=src_i;i<=tar_i;i++){\r\n      for(let j=src_j;j<=tar_j;j++){\r\n        if(this.state.cList[i][j].content ===\"\") continue;\r\n        if(this.state.cList[i][j].isFunc)  sum+=parseFloat(this.state.cList[i][j].FuncValue);\r\n        else{\r\n          if(!this.isNumeric(this.state.cList[i][j].content)) return false;\r\n          if(!isNaN(parseFloat(this.state.cList[i][j].content)))\r\n            sum+=parseFloat(this.state.cList[i][j].content);\r\n        }       \r\n      }\r\n    }\r\n    return sum;\r\n  }\r\n  rm_space = (str) => {\r\n    var sub_str = str.trim().split(\" \");\r\n    var new_str = \"\";\r\n    for (let s of sub_str) {\r\n      if (s !== \" \") new_str = new_str + s;\r\n    }\r\n    return str;\r\n  };\r\n  inrange(ij){\r\n    if(ij[0]>=0&&ij[0]<this.state.row_num&&ij[1]>=0&&ij[1]<this.state.col_num) return true;\r\n    return false;\r\n  }\r\n  parse_func = (i, j, str) => {\r\n    this.state.cList[i][j].isFunc = false;\r\n    if (str[0] === \"=\") {\r\n      var new_str = this.rm_space(str.slice(1));\r\n      this.state.cList[i][j].isFunc = true;\r\n      this.state.cList[i][j].FuncErr = true;\r\n      this.state.cList[i][j].FuncType=\"NULL\";\r\n\r\n      if (new_str.slice(0, 3) === \"sum\" || new_str.slice(0, 3) === \"Sum\") {\r\n        this.state.cList[i][j].FuncType = \"sum\";\r\n        var in_str = new_str.slice(3);\r\n        if (in_str[0] === \"(\" && in_str[in_str.length - 1] === \")\") {\r\n          in_str = in_str.slice(1, in_str.length - 1).split(\":\");\r\n          if (in_str.length == 2) {\r\n            var c1 = this.id2ij(in_str[0]),\r\n              c2 = this.id2ij(in_str[1]);\r\n            if (c1[0] !== -1 && c2[0] !== -1) {\r\n              if(this.inrange(c1)&&this.inrange(c2)){\r\n                var x = this.sum_cells(c1[0], c1[1], c2[0], c2[1]);\r\n                if (x !== false) {\r\n                  this.state.cList[i][j].FuncErr = false;\r\n                  this.state.cList[i][j].FuncValue = x;\r\n                  this.state.cList[i][j].FuncRef = [c1, c2];\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } else if (this.id2ij(new_str)[0] !== -1) {\r\n        var src = this.id2ij(new_str);\r\n        if(src[0]===i&&src[1]===j) return;\r\n        if(this.inrange(src)){\r\n          var src_ref=this.state.cList[src[0]][src[1]].FuncRef;\r\n          var loop=false;\r\n          for(let l=0;l<2;l++){\r\n              if(src_ref[l][0]!==-1&&src_ref[l][1]!==-1){\r\n                console.log(\"in\");\r\n                if(src_ref[l][0]===i&&src_ref[l][1]===j) {loop=true;}\r\n              }\r\n          }\r\n          if(loop){\r\n\r\n          }\r\n          else{\r\n            this.state.cList[i][j].FuncErr = false;\r\n            this.state.cList[i][j].FuncType = \"ref\";\r\n            this.state.cList[i][j].FuncValue = this.get_cell_value(src[0], src[1]);\r\n            this.state.cList[i][j].FuncRef[0] = [src[0], src[1]];\r\n          }\r\n        }\r\n      } else if (new_str.includes(\"+\") || new_str.includes(\"-\")) {\r\n        var sign = \" \";\r\n        if (new_str.includes(\"+\")) sign = \"+\";\r\n        else if (new_str.includes(\"-\")) sign = \"-\";\r\n        var in_str = new_str.split(sign);\r\n        if (in_str.length == 2) {\r\n          var c = [this.id2ij(in_str[0]), this.id2ij(in_str[1])];\r\n          var v = [NaN, NaN];\r\n          for (let l = 0; l < 2; l++) {\r\n            if (c[l][0] === -1) {\r\n              if (in_str[l] === \"\") {\r\n                v[l] = 0;\r\n              } else if (this.isNumeric(in_str[l])) {\r\n                v[l] = parseFloat(in_str[l]);\r\n              }\r\n            } else {\r\n              if(!this.inrange(c[l])) return;\r\n              v[l] = this.get_cell_value(c[l][0], c[l][1]);\r\n              this.state.cList[i][j].FuncRef[l] = [c[l][0], c[l][1]];\r\n            }\r\n          }\r\n          if (!isNaN(v[0]) && !isNaN(v[1])) {\r\n            //string\r\n            if (v[0] == \"\") v[0] = 0;\r\n            if (v[1] == \"\") v[1] = 0;\r\n            if (!isNaN(parseInt(v[0])) && !isNaN(parseInt(v[1]))) {\r\n              //space\r\n              if (sign === \"+\") {\r\n                this.state.cList[i][j].FuncErr = false;\r\n                this.state.cList[i][j].FuncType = \"plus\";\r\n                this.state.cList[i][j].FuncValue =\r\n                  parseFloat(v[0]) + parseFloat(v[1]);\r\n              } else if (sign === \"-\") {\r\n                this.state.cList[i][j].FuncErr = false;\r\n                this.state.cList[i][j].FuncType = \"minus\";\r\n                this.state.cList[i][j].FuncValue =\r\n                  parseFloat(v[0]) - parseFloat(v[1]);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n  get_cell_value = (i, j) => {\r\n    this.parse_func(i, j, this.state.cList[i][j].content);\r\n    if (this.state.cList[i][j].isFunc) {\r\n      if (this.state.cList[i][j].FuncErr) return \"ERROR!\";\r\n      return this.state.cList[i][j].FuncValue;\r\n    } else {\r\n      return this.state.cList[i][j].content;\r\n    }\r\n  };\r\n  componentWillUpdate(nextProps, nextState) {\r\n    for (let t = 0; t < 2; t++) {\r\n      for (let i = 0; i < this.state.row_num; i++) {\r\n        for (let j = 0; j < this.state.col_num; j++) {\r\n          let s = this.ij2id(i, j);\r\n          var fcs_in = document.getElementById(s);\r\n          fcs_in.value = this.get_cell_value(i, j);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  /*componentDidUpdate(){\r\n    if(this.state.fcs[0]!==-1 ){\r\n      document.getElementById(this.ij2id(this.state.fcs[0],this.state.fcs[1])).focus();\r\n    }\r\n  }*/\r\n  render() {\r\n    console.log(\"fcs on:\" + this.state.fcs[0] + \",\" + this.state.fcs[1]);\r\n    var rows = [];\r\n    var table = [];\r\n    var arow = [];\r\n    for (let j = 0; j < this.state.col_num; j++)\r\n      arow = arow.concat(\r\n        <th id={\"th\" + Table.col_id2str(j)}>{Table.col_id2str(j)}</th>\r\n      );\r\n    rows = rows.concat([arow]);\r\n    for (let i = 0; i < this.state.row_num; i++) {\r\n      arow = this.state.cList[i].map((e,index) => {\r\n        let s=this.ij2id(i,index);\r\n        return (\r\n          <td >\r\n            <input type=\"text\" id={s} \r\n            onClick={(e)=>{this.cell_clk(i,index)}}  onBlur={()=>{this.cell_blur(i,index)}}\r\n            onKeyDown={(e)=>{this.cell_key(i,index,e)}} \r\n             />\r\n          </td>\r\n        );\r\n      });\r\n      rows = rows.concat([arow]);\r\n    }\r\n    \r\n    return (\r\n      <header className=\"Table\">\r\n        <button id=\"cp\" onMouseDown={()=>{this.add_col(this.state.fcs)}}>+</button>\r\n        <button id=\"cm\" onMouseDown={()=>{this.del_col(this.state.fcs)}}>-</button>\r\n        <button id=\"rp\" onMouseDown={()=>{this.add_row(this.state.fcs)}}>+</button>\r\n        <button id=\"rm\" onMouseDown={()=>{this.del_row(this.state.fcs)}}>-</button>\r\n        <button id=\"copy\" onMouseDown={()=>{this.copy_cell(this.state.fcs)}}>copy</button>\r\n        <button id=\"paste\" onMouseDown={()=>{this.paste_cell(this.state.fcs)}}>paste</button>\r\n        <table >\r\n        {rows.map((e,index)=>{return <tr><th id={\"th\"+index} >{(index===0)? \"\":index}</th>{e}</tr>})}          \r\n        </table>\r\n      </header >\r\n    );\r\n  }\r\n}\r\nexport default Table;\r\n","import React, { Component } from \"react\";\nimport Table from \"../components/Table\";\nclass FakeSheet extends Component {\n    render() {\n        return (\n            <>\n                <Table  text=\"todos\"/>\n            </>\n        );\n    }\n}\n\nexport default FakeSheet;\n\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport FakeSheet from \"./containers/FakeSheet\";\n\nReactDOM.render(\n    <FakeSheet />,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}