(this.webpackJsonpfakesheet=this.webpackJsonpfakesheet||[]).push([[0],{14:function(t,e,c){"use strict";c.r(e);var n=c(1),s=c(7),i=c.n(s),a=c(2),r=c(3),u=c(5),o=c(4),l=c(8),f=c(0),d=function(t){Object(u.a)(c,t);var e=Object(o.a)(c);function c(t){var n;Object(a.a)(this,c),(n=e.call(this,t)).isNumeric=function(t){return!isNaN(t)},n.ij2id=function(t,e){return c.col_id2str(e)+(t+1)},n.id2ij=function(t){if((t=t.toUpperCase()).length>=2){var e=t.charCodeAt(0)-"A".charCodeAt(0),s=t.charCodeAt(1)-"A".charCodeAt(0),i=0,a=0,r=!1;if(e>=0&&e<26&&(s>=0&&s<26?(a=c.col_str2id(t.slice(0,2)),n.isNumeric(t.slice(2))&&(i=parseInt(t.slice(2))-1,r=!0)):(a=c.col_str2id(t.slice(0,1)),n.isNumeric(t.slice(1))&&(i=parseInt(t.slice(1))-1,r=!0))),r)return[i,a]}return[-1,-1]},n.cell_blur=function(t,e){console.log("blur");var s=document.getElementById(n.ij2id(t,e)),i=document.getElementById("th"+(t+1)),a=document.getElementById("th"+c.col_id2str(e));i.classList.remove("fcs"),a.classList.remove("fcs"),n.state.cList[t][e].isFunc||(n.state.cList[t][e].content=s.value),n.e_flag&&(n.state.fcs=[-1,-1]),n.e_flag=!0,n.state.cList[t][e].clk=0,n.setState((function(t){return{flag:t.flag+1}}))},n.cell_clk=function(t,e){var s=document.getElementById(n.ij2id(t,e)),i=document.getElementById("th"+(t+1)),a=document.getElementById("th"+c.col_id2str(e));if(i.classList.add("fcs"),a.classList.add("fcs"),0===n.state.cList[t][e].clk){n.state.fcs=[t,e],s.value=n.state.cList[t][e].content;n.ij2id(t,e);n.state.cList[t][e].clk=1}else if(1===n.state.cList[t][e].clk){n.ij2id(t,e);n.state.cList[t][e].clk=2}},n.cell_key=function(t,e,c){if("Enter"===c.key){n.e_flag=!1;var s=document.getElementById(n.ij2id(t,e));2==n.state.cList[t][e].clk&&(n.state.cList[t][e].content=s.value);var i=Math.min(t+1,n.state.row_num-1);return n.state.fcs=[i,e],document.getElementById(n.ij2id(i,e)).focus(),n.state.cList[i][e].clk=1,void n.setState((function(t){return{flag:t.flag+1}}))}1===n.state.cList[t][e].clk&&("Backspace"===c.key||c.key,document.getElementById(n.ij2id(t,e)).value="",n.state.cList[t][e].clk=2)},n.pass_cell=function(t,e,c,s){for(var i in n.state.cList[t][e])void 0!==i&&(n.state.cList[c][s][i]=n.state.cList[t][e][i])},n.renew_cell_func=function(t,e,c,s){var i=n.state.cList[t][e],a=i.FuncType;if("NULL"===a)return!1;if("ref"===a){var r=!1;"+r"===c?i.FuncRef[0][0]>=s[0]&&i.FuncRef[0][0]++:"-r"===c?(i.FuncRef[0][0]>s[0]&&i.FuncRef[0][0]--,i.FuncRef[0][0]==s[0]&&(r=!0)):"+c"===c?i.FuncRef[0][1]>=s[1]&&i.FuncRef[0][1]++:"-c"===c&&(i.FuncRef[0][1]>s[1]&&i.FuncRef[0][1]--,i.FuncRef[0][1]==s[1]&&(r=!0)),r?(i.content="ERROR!",i.isFunc=!1):i="="+n.ij2id(i.FuncRef[0][0],i.FuncRef[0][1])}else{if("+r"===c)for(var u=0;u<2;u++)i.FuncRef[u][0]>=s[0]&&i.FuncRef[u][0]++;else if("-r"===c)for(var o=0;o<2;o++)i.FuncRef[o][0]>=s[0]&&i.FuncRef[o][0]--;else if("+c"===c)for(var l=0;l<2;l++)i.FuncRef[l][1]>=s[1]&&i.FuncRef[l][1]++;else if("-c"===c)for(var f=0;f<2;f++)i.FuncRef[f][1]>=s[1]&&i.FuncRef[f][1]--;"sum"===a?n.state.cList[t][e].content="=sum("+n.ij2id(i.FuncRef[0][0],i.FuncRef[0][1])+":"+n.ij2id(i.FuncRef[1][0],i.FuncRef[1][1])+")":"plus"===a?n.state.cList[t][e].content="="+n.ij2id(i.FuncRef[0][0],i.FuncRef[0][1])+"+"+n.ij2id(i.FuncRef[1][0],i.FuncRef[1][1]):"minus"===a&&(n.state.cList[t][e].content="="+n.ij2id(i.FuncRef[0][0],i.FuncRef[0][1])+"-"+n.ij2id(i.FuncRef[1][0],i.FuncRef[1][1]))}},n.copy_cell=function(t){if(-1!==t[0]){for(var e in void 0===n.copied_cell&&(n.copied_cell=new n.cell),n.state.cList[t[0]][t[1]])void 0!==e&&(n.copied_cell[e]=n.state.cList[t[0]][t[1]][e]);n.copied_ij=t}},n.paste_cell=function(t){if(-1!==t[0]){var e=n.state.cList[t[0]][t[1]];if(void 0!==n.copied_cell){for(var c in n.copied_cell)void 0!==c&&(e[c]=n.copied_cell[c]);if(e.isFunc){var s=[t[0]-n.copied_ij[0],t[1]-n.copied_ij[1]];if("sum"===e.FuncType){for(var i=0;i<2;i++)for(var a=0;a<2;a++)e.FuncRef[i][a]+=s[a];e.content="=sum("+n.ij2id(e.FuncRef[0][0],e.FuncRef[0][1])+":"+n.ij2id(e.FuncRef[1][0],e.FuncRef[1][1])+")"}else if("ref"===e.FuncType){for(var r=0;r<2;r++)e.FuncRef[0][r]+=s[r];e.content="="+n.ij2id(e.FuncRef[0][0],e.FuncRef[0][1])}else if("minus"===e.FuncType||"plus"===e.FuncType){for(var u=0;u<2;u++)for(var o=0;o<2;o++)-1!==e.FuncRef[u][o]&&(e.FuncRef[u][o]+=s[o]);var l;"minus"===e.FuncType?l="-":"plus"===e.FuncType&&(l="+"),e.content="="+n.ij2id(e.FuncRef[0][0],e.FuncRef[0][1])+l+n.ij2id(e.FuncRef[1][0],e.FuncRef[1][1])}n.parse_func(t[0],t[1],e.content),e.FuncErr&&(e.content="ERROR!",e.isFunc=!1)}n.setState((function(t){return{flag:t.flag+1}}))}}},n.add_col=function(t){if(-1===t[1]){t=[0,n.state.col_num-1];for(var e=0;e<n.state.row_num;e++)n.state.cList[e].push(new n.cell)}else{for(var c=0;c<n.state.row_num;c++)for(var s=0;s<n.state.col_num;s++)n.state.cList[c][s].isFunc&&n.renew_cell_func(c,s,"+c",t);for(var i=0;i<n.state.row_num;i++){n.state.cList[i].push(new n.cell);for(var a=n.state.col_num;a>t[1];a--)n.pass_cell(i,a-1,i,a);n.state.cList[i][t[1]]=new n.cell}}n.setState((function(t){return{col_num:t.col_num+1}}))},n.add_row=function(t){if(-1===t[0]){t=[n.state.row_num-1,0];for(var e=[],c=0;c<n.state.col_num;c++)e.push(new n.cell);n.state.cList.push(e)}else{for(var s=0;s<n.state.row_num;s++)for(var i=0;i<n.state.col_num;i++)n.state.cList[s][i].isFunc&&n.renew_cell_func(s,i,"+r",t);e=[];for(var a=0;a<n.state.col_num;a++)e.push(new n.cell);n.state.cList.push(e);for(var r=n.state.row_num;r>t[0];r--)for(var u=0;u<n.state.col_num;u++)n.pass_cell(r-1,u,r,u);for(var o=0;o<n.state.col_num;o++)n.state.cList[t[0]][o]=new n.cell}n.setState((function(t){return{row_num:t.row_num+1}}))},n.del_col=function(t){if(-1!==t[1]){var e=document.getElementById("th"+(t[0]+1)),s=document.getElementById("th"+c.col_id2str(t[1]));e.classList.remove("fcs"),s.classList.remove("fcs");for(var i=0;i<n.state.row_num;i++)for(var a=0;a<n.state.col_num;a++)n.state.cList[i][a].isFunc&&n.renew_cell_func(i,a,"-c",t);for(var r=0;r<n.state.row_num;r++){for(var u=t[1];u<n.state.col_num-1;u++)n.pass_cell(r,u+1,r,u);n.state.cList[r].splice(n.state.col_num-1,1)}n.state.fcs=[-1,-1],n.state.col_num--,n.setState((function(t){return{flag:t.flag-1}}))}},n.del_row=function(t){if(-1!==t[0]){var e=document.getElementById("th"+(t[0]+1)),s=document.getElementById("th"+c.col_id2str(t[1]));e.classList.remove("fcs"),s.classList.remove("fcs");for(var i=0;i<n.state.row_num;i++)for(var a=0;a<n.state.col_num;a++)n.state.cList[i][a].isFunc&&n.renew_cell_func(i,a,"-r",t);for(var r=t[0];r<n.state.row_num-1;r++)for(var u=0;u<n.state.col_num;u++)n.pass_cell(r+1,u,r,u);n.state.cList.splice(n.state.row_num-1,1),n.state.fcs=[-1,-1],n.state.row_num--,n.setState((function(t){return{flag:t.flag-1}}))}},n.sum_cells=function(t,e,c,s){if(t>c||e>s)return!1;for(var i=0,a=t;a<=c;a++)for(var r=e;r<=s;r++)if(""!==n.state.cList[a][r].content)if(n.state.cList[a][r].isFunc)i+=parseFloat(n.state.cList[a][r].FuncValue);else{if(!n.isNumeric(n.state.cList[a][r].content))return!1;isNaN(parseFloat(n.state.cList[a][r].content))||(i+=parseFloat(n.state.cList[a][r].content))}return i},n.rm_space=function(t){var e,c=t.trim().split(" "),n=Object(l.a)(c);try{for(n.s();!(e=n.n()).done;){var s=e.value;" "!==s&&s}}catch(i){n.e(i)}finally{n.f()}return t},n.parse_func=function(t,e,c){if(n.state.cList[t][e].isFunc=!1,"="===c[0]){var s=n.rm_space(c.slice(1));if(n.state.cList[t][e].isFunc=!0,n.state.cList[t][e].FuncErr=!0,n.state.cList[t][e].FuncType="NULL","sum"===s.slice(0,3)||"Sum"===s.slice(0,3)){if(n.state.cList[t][e].FuncType="sum","("===(d=s.slice(3))[0]&&")"===d[d.length-1]&&2==(d=d.slice(1,d.length-1).split(":")).length){var i=n.id2ij(d[0]),a=n.id2ij(d[1]);if(-1!==i[0]&&-1!==a[0]&&n.inrange(i)&&n.inrange(a)){var r=n.sum_cells(i[0],i[1],a[0],a[1]);!1!==r&&(n.state.cList[t][e].FuncErr=!1,n.state.cList[t][e].FuncValue=r,n.state.cList[t][e].FuncRef=[i,a])}}}else if(-1!==n.id2ij(s)[0]){var u=n.id2ij(s);if(u[0]===t&&u[1]===e)return;if(n.inrange(u)){for(var o=n.state.cList[u[0]][u[1]].FuncRef,l=!1,f=0;f<2;f++)-1!==o[f][0]&&-1!==o[f][1]&&(console.log("in"),o[f][0]===t&&o[f][1]===e&&(l=!0));l||(n.state.cList[t][e].FuncErr=!1,n.state.cList[t][e].FuncType="ref",n.state.cList[t][e].FuncValue=n.get_cell_value(u[0],u[1]),n.state.cList[t][e].FuncRef[0]=[u[0],u[1]])}}else if(s.includes("+")||s.includes("-")){var d,_=" ";if(s.includes("+")?_="+":s.includes("-")&&(_="-"),2==(d=s.split(_)).length){for(var m=[n.id2ij(d[0]),n.id2ij(d[1])],v=[NaN,NaN],F=0;F<2;F++)if(-1===m[F][0])""===d[F]?v[F]=0:n.isNumeric(d[F])&&(v[F]=parseFloat(d[F]));else{if(!n.inrange(m[F]))return;v[F]=n.get_cell_value(m[F][0],m[F][1]),n.state.cList[t][e].FuncRef[F]=[m[F][0],m[F][1]]}isNaN(v[0])||isNaN(v[1])||(""==v[0]&&(v[0]=0),""==v[1]&&(v[1]=0),isNaN(parseInt(v[0]))||isNaN(parseInt(v[1]))||("+"===_?(n.state.cList[t][e].FuncErr=!1,n.state.cList[t][e].FuncType="plus",n.state.cList[t][e].FuncValue=parseFloat(v[0])+parseFloat(v[1])):"-"===_&&(n.state.cList[t][e].FuncErr=!1,n.state.cList[t][e].FuncType="minus",n.state.cList[t][e].FuncValue=parseFloat(v[0])-parseFloat(v[1]))))}}}},n.get_cell_value=function(t,e){return n.parse_func(t,e,n.state.cList[t][e].content),n.state.cList[t][e].isFunc?n.state.cList[t][e].FuncErr?"ERROR!":n.state.cList[t][e].FuncValue:n.state.cList[t][e].content},n.state={row_num:100,col_num:26,cList:[],fcs:[-1,-1],flag:0},n.cell=function t(){Object(a.a)(this,t),this.clk=0,this.isFunc=!1,this.FuncType="NULL",this.FuncErr=!1,this.FuncValue=0,this.FuncRef=[[-1,-1],[-1,-1]],this.content=""},n.copied_cell=void 0,n.copied_ij=[-1,-1],n.e_flag=!0;for(var s=0;s<n.state.row_num;s++){n.state.cList.push([]);for(var i=0;i<n.state.col_num;i++)n.state.cList[s].push(new n.cell)}return n}return Object(r.a)(c,[{key:"inrange",value:function(t){return t[0]>=0&&t[0]<this.state.row_num&&t[1]>=0&&t[1]<this.state.col_num}},{key:"componentWillUpdate",value:function(t,e){for(var c=0;c<2;c++)for(var n=0;n<this.state.row_num;n++)for(var s=0;s<this.state.col_num;s++){var i=this.ij2id(n,s);document.getElementById(i).value=this.get_cell_value(n,s)}}},{key:"render",value:function(){var t=this;console.log("fcs on:"+this.state.fcs[0]+","+this.state.fcs[1]);for(var e=[],n=[],s=0;s<this.state.col_num;s++)n=n.concat(Object(f.jsx)("th",{id:"th"+c.col_id2str(s),children:c.col_id2str(s)}));e=e.concat([n]);for(var i=function(c){n=t.state.cList[c].map((function(e,n){var s=t.ij2id(c,n);return Object(f.jsx)("td",{children:Object(f.jsx)("input",{type:"text",id:s,onClick:function(e){t.cell_clk(c,n)},onBlur:function(){t.cell_blur(c,n)},onKeyDown:function(e){t.cell_key(c,n,e)}})})})),e=e.concat([n])},a=0;a<this.state.row_num;a++)i(a);return Object(f.jsxs)("header",{className:"Table",children:[Object(f.jsx)("button",{id:"cp",onMouseDown:function(){t.add_col(t.state.fcs)},children:"+"}),Object(f.jsx)("button",{id:"cm",onMouseDown:function(){t.del_col(t.state.fcs)},children:"-"}),Object(f.jsx)("button",{id:"rp",onMouseDown:function(){t.add_row(t.state.fcs)},children:"+"}),Object(f.jsx)("button",{id:"rm",onMouseDown:function(){t.del_row(t.state.fcs)},children:"-"}),Object(f.jsx)("button",{id:"copy",onMouseDown:function(){t.copy_cell(t.state.fcs)},children:"copy"}),Object(f.jsx)("button",{id:"paste",onMouseDown:function(){t.paste_cell(t.state.fcs)},children:"paste"}),Object(f.jsx)("table",{children:e.map((function(t,e){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{id:"th"+e,children:0===e?"":e}),t]})}))})]})}}],[{key:"col_id2str",value:function(t){var e="A".charCodeAt(0);if(t<26)return String.fromCharCode(e+t);var c=parseInt(t/26)-1,n=t%26;return String.fromCharCode(e+c)+String.fromCharCode(e+n)}},{key:"col_str2id",value:function(t){var e=0,c="A".charCodeAt(0);return 1===t.length?e=t.charCodeAt(0)-c:(e=26,e+=26*(t.charCodeAt(0)-c),e+=t.charCodeAt(1)-c),e}}]),c}(n.Component),_=function(t){Object(u.a)(c,t);var e=Object(o.a)(c);function c(){return Object(a.a)(this,c),e.apply(this,arguments)}return Object(r.a)(c,[{key:"render",value:function(){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(d,{text:"todos"})})}}]),c}(n.Component);i.a.render(Object(f.jsx)(_,{}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.3eb27e42.chunk.js.map